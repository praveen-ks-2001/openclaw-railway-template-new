<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OpenClaw Setup</title>
  <link rel="stylesheet" href="/setup/styles.css" />
</head>

<body>
  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay">
    <div class="loading-spinner"></div>
    <div class="loading-text">Setting up OpenClaw...</div>
    <div class="loading-subtext">This may take up to 30 seconds. Please wait.</div>
  </div>

  <div class="app-container">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <img src="https://raw.githubusercontent.com/openclaw/openclaw/main/docs/assets/openclaw-logo-text.png"
          alt="OpenClaw" />
        <h1>Setup Wizard</h1>
      </div>
      <div class="status-badge">
        <span id="statusDot" class="status-dot"></span>
        <span id="status">Loading...</span>
      </div>
    </header>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Sidebar -->
      <aside class="sidebar">
        <!-- Steps Guide -->
        <div class="steps-guide">
          <h3>How to Setup</h3>

          <div class="step-item">
            <span class="step-number">1</span>
            <span class="step-text"><strong>Wait for engine</strong> â€” takes ~15-20s for the engine to initialize</span>
          </div>

          <div class="step-item">
            <span class="step-number">2</span>
            <span class="step-text"><strong>Select provider</strong> â€” choose your AI provider and paste your API
              key</span>
          </div>

          <div class="step-item">
            <span class="step-number">3</span>
            <span class="step-text"><strong>Add channels</strong> (optional) â€” connect Telegram, Discord, or
              Slack</span>
          </div>

          <div class="step-item">
            <span class="step-number">4</span>
            <span class="step-text"><strong>Run setup</strong> â€” takes ~30s to configure everything</span>
          </div>

          <div class="step-item">
            <span class="step-number">5</span>
            <span class="step-text"><strong>Approve pairing</strong> â€” only if you added channel tokens</span>
          </div>

          <div class="step-item">
            <span class="step-number">6</span>
            <span class="step-text"><strong>Open UI</strong> â€” start using OpenClaw!</span>
          </div>
        </div>

        <!-- Advanced Tools (Collapsible) -->
        <div class="advanced-tools">
          <button class="advanced-toggle" onclick="toggleAdvanced()">
            <span>Advanced Tools</span>
            <span class="icon">â–¼</span>
          </button>
          <div id="advancedContent" class="advanced-content">
            <div class="advanced-panel">
              <!-- Debug Console -->
              <h4>Debug Console</h4>
              <p>Run allowlisted safe commands for debugging.</p>
              <div class="flex-row">
                <select id="consoleCmd" style="flex: 1.5">
                  <option value="gateway.restart">gateway.restart</option>
                  <option value="gateway.stop">gateway.stop</option>
                  <option value="gateway.start">gateway.start</option>
                  <option value="openclaw.status">openclaw status</option>
                  <option value="openclaw.health">openclaw health</option>
                  <option value="openclaw.doctor">openclaw doctor</option>
                  <option value="openclaw.logs">openclaw logs</option>
                  <option value="openclaw.config.get">openclaw config get</option>
                  <option value="openclaw.version">openclaw --version</option>
                </select>
                <input id="consoleArg" placeholder="Arg" style="flex: 1" />
                <button class="btn-secondary" id="consoleRun">Run</button>
              </div>
              <pre id="consoleOut" style="max-height: 150px;"></pre>

              <!-- Config Editor -->
              <h4>Config Editor</h4>
              <p>Edit <code>openclaw.json</code> directly. Saving creates a backup.</p>
              <div id="configPath" class="muted" style="font-size: 0.75rem; margin-bottom: 0.5rem;"></div>
              <textarea id="configText" style="height: 150px;"></textarea>
              <div class="button-group" style="margin-top: 0.75rem;">
                <button class="btn-secondary" id="configReload">Reload</button>
                <button class="btn-secondary" id="configSave">Save</button>
              </div>
              <pre id="configOut" style="max-height: 100px;"></pre>
            </div>
          </div>
        </div>
      </aside>

      <!-- Wizard Section -->
      <section class="wizard-section">
        <!-- Step 1: Provider -->
        <div class="card">
          <div class="card-header">
            <span class="card-step">1</span>
            <h2 class="card-title">Model / Auth Provider</h2>
          </div>

          <label>Provider Group</label>
          <select id="authGroup"></select>

          <label>Auth Method</label>
          <select id="authChoice"></select>

          <label>API Key / Token</label>
          <input id="authSecret" type="password" placeholder="Paste your API key or token" />
          <p class="hint">Required for most providers. Leave blank for OAuth-based options.</p>

          <label>Wizard Flow</label>
          <select id="flow">
            <option value="quickstart">Quickstart (recommended)</option>
            <option value="advanced">Advanced</option>
            <option value="manual">Manual</option>
          </select>
        </div>

        <!-- Step 2: Channels -->
        <div class="card">
          <div class="card-header">
            <span class="card-step">2</span>
            <h2 class="card-title">Channels</h2>
            <span class="optional-badge">Optional</span>
          </div>
          <p class="muted" style="margin-top: 0;">Connect messaging platforms. You can also add these later from the
            OpenClaw UI.</p>

          <label>Telegram Bot Token</label>
          <input id="telegramToken" type="password" placeholder="123456:ABC..." />
          <p class="hint">Get from <a href="https://t.me/BotFather" target="_blank">@BotFather</a> â†’
            <code>/newbot</code></p>

          <label>Discord Bot Token</label>
          <input id="discordToken" type="password" placeholder="Bot token from Discord Developer Portal" />
          <p class="hint">Enable <strong>MESSAGE CONTENT INTENT</strong> in Bot â†’ Privileged Gateway Intents</p>

          <label>Slack Bot Token</label>
          <input id="slackBotToken" type="password" placeholder="xoxb-..." />

          <label>Slack App Token</label>
          <input id="slackAppToken" type="password" placeholder="xapp-..." />
        </div>

        <!-- Step 3: Summary & Run -->
        <div class="card">
          <div class="card-header">
            <span class="card-step">3</span>
            <h2 class="card-title">Review & Run</h2>
          </div>

          <!-- Summary Box -->
          <div class="summary-box" id="summaryBox">
            <h4>Your Configuration</h4>
            <div class="summary-item">
              <span class="summary-label">Provider</span>
              <span class="summary-value" id="summaryProvider">â€”</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Auth Method</span>
              <span class="summary-value" id="summaryAuth">â€”</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">API Key</span>
              <span class="summary-value masked" id="summaryKey">â€”</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Telegram</span>
              <span class="summary-value masked" id="summaryTelegram">â€”</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Discord</span>
              <span class="summary-value masked" id="summaryDiscord">â€”</span>
            </div>
            <div class="summary-item">
              <span class="summary-label">Slack</span>
              <span class="summary-value masked" id="summarySlack">â€”</span>
            </div>
          </div>

          <!-- Buttons -->
          <div class="button-group">
            <button id="run" class="btn-primary">
              <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
              </svg>
              Run Setup
            </button>
            <a id="openUiLink" href="/openclaw" target="_blank" class="btn-primary" style="text-decoration: none;">
              Open OpenClaw UI
            </a>
            <button id="pairingApprove" class="btn-secondary">Approve Pairing</button>
            <button id="reset" class="btn-outline">Reset</button>
          </div>

          <!-- Log Output -->
          <pre id="log"></pre>

          <p class="muted mt-2">
            <strong>Tip:</strong> After setup completes, click <strong>Approve Pairing</strong> if you added
            Telegram/Discord tokens,
            then click <strong>Open OpenClaw UI</strong>.
          </p>
        </div>

        <!-- Quick Links -->
        <div class="card" style="padding: 1rem 1.5rem; background: transparent; border-style: dashed;">
          <div class="flex-row" style="justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
            <a href="/setup/export" target="_blank">ðŸ“¦ Download Backup (.tar.gz)</a>
            <a href="https://docs.openclaw.ai/" target="_blank">ðŸ“š OpenClaw Documentation</a>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script>
    function toggleAdvanced() {
      var btn = document.querySelector('.advanced-toggle');
      var content = document.getElementById('advancedContent');
      btn.classList.toggle('open');
      content.classList.toggle('open');
    }
  </script>
  <script src="/setup/app.js"></script>
</body>

</html>